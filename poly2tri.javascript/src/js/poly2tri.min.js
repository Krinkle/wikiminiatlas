var p2t={sweep:{}};p2t.Point=function(){this.x=null;this.y=null;if(arguments.length==0){this.x=0;this.y=0}else{if(arguments.length==2){this.x=arguments[0];this.y=arguments[1]}else{}}this.edge_list=[]};p2t.Point.prototype.set_zero=function(){this.x=0;this.y=0};p2t.Point.prototype.set=function(a,b){this.x=a;this.y=b};p2t.Point.prototype.negate=function(){this.x=-this.x;this.y=-this.y};p2t.Point.prototype.add=function(a){this.x+=a.x;this.y+=a.y};p2t.Point.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};p2t.Point.prototype.mul=function(a){this.x*=a;this.y*=a};p2t.Point.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};p2t.Point.prototype.normalize=function(){var a=this.length();this.x/=a;this.y/=a;return a};p2t.Point.prototype.equals=function(a){return p2t.equals(this,a)};p2t.negate=function(a){return new p2t.Point(-a.x,-a.y)};p2t.cmp=function(d,c){if(d.y==c.y){return d.x-c.x}else{return d.y-c.y}};p2t.add=function(d,c){return new p2t.Point(d.x+c.x,d.y+c.y)};p2t.sub=function(d,c){return new p2t.Point(d.x-c.x,d.y-c.y)};p2t.mul=function(a,b){return new p2t.Point(a*b.x,a*b.y)};p2t.equals=function(d,c){return d.x==c.x&&d.y==c.y};p2t.dot=function(d,c){return d.x*c.x+d.y*c.y};p2t.cross=function(){var a=false;var b=false;if(arguments.length==2){if(typeof(arguments[0])=="number"){a=true}if(typeof(arguments[1]=="number")){b=true}if(a){if(b){return arguments[0].x*arguments[1].y-arguments[0].y*arguments[1].x}else{return new p2t.Point(arguments[1]*arguments[0].y,-arguments[1]*arguments[0].x)}}else{if(b){return new p2t.Point(-arguments[0]*arguments[1].y,arguments[0]*arguments[1].x)}else{return arguments[0]*arguments[1]}}}else{return undefined}};p2t.Edge=function(){this.p=null;this.q=null;if(arguments.length==2){if(arguments[0].y>arguments[1].y){this.q=arguments[0];this.p=arguments[1]}else{if(arguments[0].y==arguments[1].y){if(arguments[0].x>arguments[1].x){this.q=arguments[0];this.p=arguments[1]}else{if(arguments[0].x==arguments[1].x){}else{this.p=arguments[0];this.q=arguments[1]}}}else{this.p=arguments[0];this.q=arguments[1]}}}else{}this.q.edge_list.push(this)};p2t.Triangle=function(c,b,a){this.points_=[null,null,null];this.neighbors_=[null,null,null];this.interior_=false;this.constrained_edge=[false,false,false];this.delaunay_edge=[false,false,false];if(arguments.length==3){this.points_[0]=c;this.points_[1]=b;this.points_[2]=a}};p2t.Triangle.prototype.GetPoint=function(a){return this.points_[a]};p2t.Triangle.prototype.GetNeighbor=function(a){return this.neighbors_[a]};p2t.Triangle.prototype.ContainsP=function(){var a=true;for(var b=0;b<arguments.length;++b){a=a&&(arguments[b].equals(this.points_[0])||arguments[b].equals(this.points_[1])||arguments[b].equals(this.points_[2]))}return a};p2t.Triangle.prototype.ContainsE=function(){var a=true;for(var b=0;b<arguments.length;++b){a=a&&this.ContainsP(arguments[b].p,arguments[b].q)}return a};p2t.Triangle.prototype.IsInterior=function(){if(arguments.length==0){return this.interior_}else{this.interior_=arguments[0];return this.interior_}};p2t.Triangle.prototype.MarkNeighbor=function(){var a;if(arguments.length==3){var c=arguments[0];var b=arguments[1];a=arguments[2];if((c.equals(this.points_[2])&&b.equals(this.points_[1]))||(c.equals(this.points_[1])&&b.equals(this.points_[2]))){this.neighbors_[0]=a}else{if((c.equals(this.points_[0])&&b.equals(this.points_[2]))||(c.equals(this.points_[2])&&b.equals(this.points_[0]))){this.neighbors_[1]=a}else{if((c.equals(this.points_[0])&&b.equals(this.points_[1]))||(c.equals(this.points_[1])&&b.equals(this.points_[0]))){this.neighbors_[2]=a}}}}else{if(arguments.length==1){a=arguments[0];if(a.ContainsP(this.points_[1],this.points_[2])){this.neighbors_[0]=a;a.MarkNeighbor(this.points_[1],this.points_[2],this)}else{if(a.ContainsP(this.points_[0],this.points_[2])){this.neighbors_[1]=a;a.MarkNeighbor(this.points_[0],this.points_[2],this)}else{if(a.ContainsP(this.points_[0],this.points_[1])){this.neighbors_[2]=a;a.MarkNeighbor(this.points_[0],this.points_[1],this)}}}}else{}}};p2t.Triangle.prototype.ClearNeigbors=function(){this.neighbors_[0]=null;this.neighbors_[1]=null;this.neighbors_[2]=null};p2t.Triangle.prototype.ClearDelunayEdges=function(){this.delaunay_edge[0]=false;this.delaunay_edge[1]=false;this.delaunay_edge[2]=false};p2t.Triangle.prototype.PointCW=function(a){if(a.equals(this.points_[0])){return this.points_[2]}else{if(a.equals(this.points_[1])){return this.points_[0]}else{if(a.equals(this.points_[2])){return this.points_[1]}else{return null}}}};p2t.Triangle.prototype.PointCCW=function(a){if(a.equals(this.points_[0])){return this.points_[1]}else{if(a.equals(this.points_[1])){return this.points_[2]}else{if(a.equals(this.points_[2])){return this.points_[0]}else{return null}}}};p2t.Triangle.prototype.NeighborCW=function(a){if(a.equals(this.points_[0])){return this.neighbors_[1]}else{if(a.equals(this.points_[1])){return this.neighbors_[2]}else{return this.neighbors_[0]}}};p2t.Triangle.prototype.NeighborCCW=function(a){if(a.equals(this.points_[0])){return this.neighbors_[2]}else{if(a.equals(this.points_[1])){return this.neighbors_[0]}else{return this.neighbors_[1]}}};p2t.Triangle.prototype.GetConstrainedEdgeCW=function(a){if(a.equals(this.points_[0])){return this.constrained_edge[1]}else{if(a.equals(this.points_[1])){return this.constrained_edge[2]}else{return this.constrained_edge[0]}}};p2t.Triangle.prototype.GetConstrainedEdgeCCW=function(a){if(a.equals(this.points_[0])){return this.constrained_edge[2]}else{if(a.equals(this.points_[1])){return this.constrained_edge[0]}else{return this.constrained_edge[1]}}};p2t.Triangle.prototype.SetConstrainedEdgeCW=function(b,a){if(b.equals(this.points_[0])){this.constrained_edge[1]=a}else{if(b.equals(this.points_[1])){this.constrained_edge[2]=a}else{this.constrained_edge[0]=a}}};p2t.Triangle.prototype.SetConstrainedEdgeCCW=function(b,a){if(b.equals(this.points_[0])){this.constrained_edge[2]=a}else{if(b.equals(this.points_[1])){this.constrained_edge[0]=a}else{this.constrained_edge[1]=a}}};p2t.Triangle.prototype.GetDelaunayEdgeCW=function(a){if(a.equals(this.points_[0])){return this.delaunay_edge[1]}else{if(a.equals(this.points_[1])){return this.delaunay_edge[2]}else{return this.delaunay_edge[0]}}};p2t.Triangle.prototype.GetDelaunayEdgeCCW=function(a){if(a.equals(this.points_[0])){return this.delaunay_edge[2]}else{if(a.equals(this.points_[1])){return this.delaunay_edge[0]}else{return this.delaunay_edge[1]}}};p2t.Triangle.prototype.SetDelaunayEdgeCW=function(b,a){if(b.equals(this.points_[0])){this.delaunay_edge[1]=a}else{if(b.equals(this.points_[1])){this.delaunay_edge[2]=a}else{this.delaunay_edge[0]=a}}};p2t.Triangle.prototype.SetDelaunayEdgeCCW=function(b,a){if(b.equals(this.points_[0])){this.delaunay_edge[2]=a}else{if(b.equals(this.points_[1])){this.delaunay_edge[0]=a}else{this.delaunay_edge[1]=a}}};p2t.Triangle.prototype.NeighborAcross=function(a){if(a.equals(this.points_[0])){return this.neighbors_[0]}else{if(a.equals(this.points_[1])){return this.neighbors_[1]}else{return this.neighbors_[2]}}};p2t.Triangle.prototype.OppositePoint=function(b,c){var a=b.PointCW(c);return this.PointCW(a)};p2t.Triangle.prototype.Legalize=function(){if(arguments.length==1){this.Legalize(this.points_[0],arguments[0])}else{if(arguments.length==2){var a=arguments[0];var b=arguments[1];if(a.equals(this.points_[0])){this.points_[1]=this.points_[0];this.points_[0]=this.points_[2];this.points_[2]=b}else{if(a.equals(this.points_[1])){this.points_[2]=this.points_[1];this.points_[1]=this.points_[0];this.points_[0]=b}else{if(a.equals(this.points_[2])){this.points_[0]=this.points_[2];this.points_[2]=this.points_[1];this.points_[1]=b}else{}}}}else{}}};p2t.Triangle.prototype.Index=function(a){if(a.equals(this.points_[0])){return 0}else{if(a.equals(this.points_[1])){return 1}else{if(a.equals(this.points_[2])){return 2}else{return -1}}}};p2t.Triangle.prototype.EdgeIndex=function(b,a){if(b.equals(this.points_[0])){if(a.equals(this.points_[1])){return 2}else{if(a.equals(this.points_[2])){return 1}}}else{if(b.equals(this.points_[1])){if(a.equals(this.points_[2])){return 0}else{if(a.equals(this.points_[0])){return 2}}}else{if(b.equals(this.points_[2])){if(a.equals(this.points_[0])){return 1}else{if(a.equals(this.points_[1])){return 0}}}}}return -1};p2t.Triangle.prototype.MarkConstrainedEdge=function(){if(arguments.length==1){if(typeof(arguments[0])=="number"){this.constrained_edge[arguments[0]]=true}else{this.MarkConstrainedEdge(arguments[0].p,arguments[0].q)}}else{if(arguments.length==2){var b=arguments[0];var a=arguments[1];if((a.equals(this.points_[0])&&b.equals(this.points_[1]))||(a.equals(this.points_[1])&&b.equals(this.points_[0]))){this.constrained_edge[2]=true}else{if((a.equals(this.points_[0])&&b.equals(this.points_[2]))||(a.equals(this.points_[2])&&b.equals(this.points_[0]))){this.constrained_edge[1]=true}else{if((a.equals(this.points_[1])&&b.equals(this.points_[2]))||(a.equals(this.points_[2])&&b.equals(this.points_[1]))){this.constrained_edge[0]=true}}}}else{}}};p2t.PI_3div4=3*Math.PI/4;p2t.PI_2=Math.PI/2;p2t.EPSILON=1e-12;p2t.kAlpha=0.3;p2t.Orientation={CW:1,CCW:-1,COLLINEAR:0};p2t.Orient2d=function(c,b,a){var e=(c.x-a.x)*(b.y-a.y);var d=(c.y-a.y)*(b.x-a.x);var f=e-d;if(f>-(p2t.EPSILON)&&f<(p2t.EPSILON)){return p2t.Orientation.COLLINEAR}else{if(f>0){return p2t.Orientation.CCW}else{return p2t.Orientation.CW}}};p2t.InScanArea=function(c,b,a,r){var l=r.x;var k=r.y;var f=c.x-l;var e=c.y-k;var p=b.x-l;var o=b.y-k;var d=f*o;var n=p*e;var j=d-n;if(j<=(p2t.EPSILON)){return false}var i=a.x-l;var h=a.y-k;var q=i*e;var m=f*h;var g=q-m;if(g<=(p2t.EPSILON)){return false}return true};p2t.Node=function(){this.point=null;this.triangle=null;this.next=null;this.prev=null;this.value=0;if(arguments.length==1){this.point=arguments[0];this.value=this.point.x}else{if(arguments.length==2){this.point=arguments[0];this.triangle=arguments[1];this.value=this.point.x}else{}}};p2t.AdvancingFront=function(b,a){this.head_=b;this.tail_=a;this.search_node_=b};p2t.AdvancingFront.prototype.head=function(){return this.head_};p2t.AdvancingFront.prototype.set_head=function(a){this.head_=a};p2t.AdvancingFront.prototype.tail=function(){return this.tail_};p2t.AdvancingFront.prototype.set_tail=function(a){this.tail_=a};p2t.AdvancingFront.prototype.search=function(){return this.search_node_};p2t.AdvancingFront.prototype.set_search=function(a){this.search_node_=a};p2t.AdvancingFront.prototype.FindSearchNode=function(a){return this.search_node_};p2t.AdvancingFront.prototype.LocateNode=function(a){var b=this.search_node_;if(a<b.value){while((b=b.prev)!=null){if(a>=b.value){this.search_node_=b;return b}}}else{while((b=b.next)!=null){if(a<b.value){this.search_node_=b.prev;return b.prev}}}return null};p2t.AdvancingFront.prototype.LocatePoint=function(b){var c=b.x;var d=this.FindSearchNode(c);var a=d.point.x;if(c==a){if(d.prev&&b.equals(d.prev.point)){d=d.prev}else{if(d.next&&b.equals(d.next.point)){d=d.next}else{if(b.equals(d.point)){}else{return null}}}}else{if(c<a){while((d=d.prev)!=null){if(b.equals(d.point)){break}}}else{while((d=d.next)!=null){if(b.equals(d.point)){break}}}}if(d!=null){this.search_node_=d}return d};p2t.Basin=function(){this.left_node=null;this.bottom_node=null;this.right_node=null;this.width=0;this.left_highest=false};p2t.Basin.prototype.Clear=function(){this.left_node=null;this.bottom_node=null;this.right_node=null;this.width=0;this.left_highest=false};p2t.EdgeEvent=function(){this.constrained_edge=null;this.right=false};p2t.SweepContext=function(a){this.triangles_=[];this.map_=[];this.points_=a;this.edge_list=[];this.front_=null;this.head_=null;this.tail_=null;this.af_head_=null;this.af_middle_=null;this.af_tail_=null;this.basin=new p2t.Basin();this.edge_event=new p2t.EdgeEvent();this.InitEdges(this.points_)};p2t.SweepContext.prototype.AddHole=function(a){this.InitEdges(a);for(var b in a){this.points_.push(a[b])}};p2t.SweepContext.prototype.front=function(){return this.front_};p2t.SweepContext.prototype.point_count=function(){return this.points_.length};p2t.SweepContext.prototype.head=function(){return this.head_};p2t.SweepContext.prototype.set_head=function(a){this.head_=a};p2t.SweepContext.prototype.tail=function(){return this.tail_};p2t.SweepContext.prototype.set_tail=function(a){this.tail_=a};p2t.SweepContext.prototype.GetTriangles=function(){return this.triangles_};p2t.SweepContext.prototype.GetMap=function(){return this.map_};p2t.SweepContext.prototype.InitTriangulation=function(){var d=this.points_[0].x;var g=this.points_[0].x;var a=this.points_[0].y;var f=this.points_[0].y;for(var e in this.points_){var h=this.points_[e];if(h.x>d){d=h.x}if(h.x<g){g=h.x}if(h.y>a){a=h.y}if(h.y<f){f=h.y}}var c=p2t.kAlpha*(d-g);var b=p2t.kAlpha*(a-f);this.head_=new p2t.Point(d+c,f-b);this.tail_=new p2t.Point(g-b,f-b);this.points_.sort(p2t.cmp)};p2t.SweepContext.prototype.InitEdges=function(a){for(var b=0;b<a.length;++b){this.edge_list.push(new p2t.Edge(a[b],a[(b+1)%a.length]))}};p2t.SweepContext.prototype.GetPoint=function(a){return this.points_[a]};p2t.SweepContext.prototype.AddToMap=function(a){this.map_.push(a)};p2t.SweepContext.prototype.LocateNode=function(a){return this.front_.LocateNode(a.x)};p2t.SweepContext.prototype.CreateAdvancingFront=function(){var c;var b;var a;var d=new p2t.Triangle(this.points_[0],this.tail_,this.head_);this.map_.push(d);c=new p2t.Node(d.GetPoint(1),d);b=new p2t.Node(d.GetPoint(0),d);a=new p2t.Node(d.GetPoint(2));this.front_=new p2t.AdvancingFront(c,a);c.next=b;b.next=a;b.prev=c;a.prev=b};p2t.SweepContext.prototype.RemoveNode=function(a){};p2t.SweepContext.prototype.MapTriangleToNodes=function(b){for(var a=0;a<3;++a){if(b.GetNeighbor(a)==null){var c=this.front_.LocatePoint(b.PointCW(b.GetPoint(a)));if(c!=null){c.triangle=b}}}};p2t.SweepContext.prototype.RemoveFromMap=function(b){for(var a in this.map_){if(this.map_[a]==b){delete this.map_[a];break}}};p2t.SweepContext.prototype.MeshClean=function(b){if(b!=null&&!b.IsInterior()){b.IsInterior(true);this.triangles_.push(b);for(var a=0;a<3;++a){if(!b.constrained_edge[a]){this.MeshClean(b.GetNeighbor(a))}}}};p2t.sweep.Triangulate=function(a){a.InitTriangulation();a.CreateAdvancingFront();p2t.sweep.SweepPoints(a);p2t.sweep.FinalizationPolygon(a)};p2t.sweep.SweepPoints=function(e){for(var c=1;c<e.point_count();++c){var a=e.GetPoint(c);var d=p2t.sweep.PointEvent(e,a);for(var b=0;b<a.edge_list.length;++b){p2t.sweep.EdgeEvent(e,a.edge_list[b],d)}}};p2t.sweep.FinalizationPolygon=function(c){var a=c.front().head().next.triangle;var b=c.front().head().next.point;while(!a.GetConstrainedEdgeCW(b)){a=a.NeighborCCW(b)}c.MeshClean(a)};p2t.sweep.PointEvent=function(c,a){var b=c.LocateNode(a);var d=p2t.sweep.NewFrontTriangle(c,a,b);if(a.x<=b.point.x+(p2t.EPSILON)){p2t.sweep.Fill(c,b)}p2t.sweep.FillAdvancingFront(c,d);return d};p2t.sweep.EdgeEvent=function(){var f;if(arguments.length==3){f=arguments[0];var a=arguments[1];var d=arguments[2];f.edge_event.constrained_edge=a;f.edge_event.right=(a.p.x>a.q.x);if(p2t.sweep.IsEdgeSideOfTriangle(d.triangle,a.p,a.q)){return}p2t.sweep.FillEdgeEvent(f,a,d);p2t.sweep.EdgeEvent(f,a.p,a.q,d.triangle,a.q)}else{if(arguments.length==5){f=arguments[0];var k=arguments[1];var j=arguments[2];var e=arguments[3];var g=arguments[4];if(p2t.sweep.IsEdgeSideOfTriangle(e,k,j)){return}var i=e.PointCCW(g);var c=p2t.Orient2d(j,i,k);if(c==p2t.Orientation.COLLINEAR){return}var h=e.PointCW(g);var b=p2t.Orient2d(j,h,k);if(b==p2t.Orientation.COLLINEAR){return}if(c==b){if(c==p2t.Orientation.CW){e=e.NeighborCCW(g)}else{e=e.NeighborCW(g)}p2t.sweep.EdgeEvent(f,k,j,e,g)}else{p2t.sweep.FlipEdgeEvent(f,k,j,e,g)}}else{}}};p2t.sweep.IsEdgeSideOfTriangle=function(e,b,a){var c=e.EdgeIndex(b,a);if(c!=-1){e.MarkConstrainedEdge(c);var d=e.GetNeighbor(c);if(d!=null){d.MarkConstrainedEdge(b,a)}return true}return false};p2t.sweep.NewFrontTriangle=function(d,a,b){var c=new p2t.Triangle(a,b.point,b.next.point);c.MarkNeighbor(b.triangle);d.AddToMap(c);var e=new p2t.Node(a);e.next=b.next;e.prev=b;b.next.prev=e;b.next=e;if(!p2t.sweep.Legalize(d,c)){d.MapTriangleToNodes(c)}return e};p2t.sweep.Fill=function(c,a){var b=new p2t.Triangle(a.prev.point,a.point,a.next.point);b.MarkNeighbor(a.prev.triangle);b.MarkNeighbor(a.triangle);c.AddToMap(b);a.prev.next=a.next;a.next.prev=a.prev;if(!p2t.sweep.Legalize(c,b)){c.MapTriangleToNodes(b)}};p2t.sweep.FillAdvancingFront=function(c,d){var a=d.next;var b;while(a.next!=null){b=p2t.sweep.HoleAngle(a);if(b>p2t.PI_2||b<-(p2t.PI_2)){break}p2t.sweep.Fill(c,a);a=a.next}a=d.prev;while(a.prev!=null){b=p2t.sweep.HoleAngle(a);if(b>p2t.PI_2||b<-(p2t.PI_2)){break}p2t.sweep.Fill(c,a);a=a.prev}if(d.next!=null&&d.next.next!=null){b=p2t.sweep.BasinAngle(d);if(b<p2t.PI_3div4){p2t.sweep.FillBasin(c,d)}}};p2t.sweep.BasinAngle=function(b){var c=b.point.x-b.next.next.point.x;var a=b.point.y-b.next.next.point.y;return Math.atan2(a,c)};p2t.sweep.HoleAngle=function(b){var c=b.next.point.x-b.point.x;var a=b.next.point.y-b.point.y;var e=b.prev.point.x-b.point.x;var d=b.prev.point.y-b.point.y;return Math.atan2(c*d-a*e,c*e+a*d)};p2t.sweep.Legalize=function(f,h){for(var d=0;d<3;++d){if(h.delaunay_edge[d]){continue}var c=h.GetNeighbor(d);if(c!=null){var a=h.GetPoint(d);var e=c.OppositePoint(h,a);var g=c.Index(e);if(c.constrained_edge[g]||c.delaunay_edge[g]){h.constrained_edge[d]=c.constrained_edge[g];continue}var b=p2t.sweep.Incircle(a,h.PointCCW(a),h.PointCW(a),e);if(b){h.delaunay_edge[d]=true;c.delaunay_edge[g]=true;p2t.sweep.RotateTrianglePair(h,a,c,e);var j=!p2t.sweep.Legalize(f,h);if(j){f.MapTriangleToNodes(h)}j=!p2t.sweep.Legalize(f,c);if(j){f.MapTriangleToNodes(c)}h.delaunay_edge[d]=false;c.delaunay_edge[g]=false;return true}}}return false};p2t.sweep.Incircle=function(c,b,a,v){var f=c.x-v.x;var e=c.y-v.y;var r=b.x-v.x;var q=b.y-v.y;var d=f*q;var p=r*e;var m=d-p;if(m<=0){return false}var j=a.x-v.x;var i=a.y-v.y;var t=j*e;var o=f*i;var g=t-o;if(g<=0){return false}var s=r*i;var l=j*q;var k=f*f+e*e;var u=r*r+q*q;var n=j*j+i*i;var h=k*(s-l)+u*g+n*m;return h>0};p2t.sweep.RotateTrianglePair=function(q,b,g,l){var o;var n;var m;var k;o=q.NeighborCCW(b);n=q.NeighborCW(b);m=g.NeighborCCW(l);k=g.NeighborCW(l);var e;var d;var c;var a;e=q.GetConstrainedEdgeCCW(b);d=q.GetConstrainedEdgeCW(b);c=g.GetConstrainedEdgeCCW(l);a=g.GetConstrainedEdgeCW(l);var j;var i;var h;var f;j=q.GetDelaunayEdgeCCW(b);i=q.GetDelaunayEdgeCW(b);h=g.GetDelaunayEdgeCCW(l);f=g.GetDelaunayEdgeCW(l);q.Legalize(b,l);g.Legalize(l,b);g.SetDelaunayEdgeCCW(b,j);q.SetDelaunayEdgeCW(b,i);q.SetDelaunayEdgeCCW(l,h);g.SetDelaunayEdgeCW(l,f);g.SetConstrainedEdgeCCW(b,e);q.SetConstrainedEdgeCW(b,d);q.SetConstrainedEdgeCCW(l,c);g.SetConstrainedEdgeCW(l,a);q.ClearNeigbors();g.ClearNeigbors();if(o){g.MarkNeighbor(o)}if(n){q.MarkNeighbor(n)}if(m){q.MarkNeighbor(m)}if(k){g.MarkNeighbor(k)}q.MarkNeighbor(g)};p2t.sweep.FillBasin=function(b,a){if(p2t.Orient2d(a.point,a.next.point,a.next.next.point)==p2t.Orientation.CCW){b.basin.left_node=a.next.next}else{b.basin.left_node=a.next}b.basin.bottom_node=b.basin.left_node;while(b.basin.bottom_node.next!=null&&b.basin.bottom_node.point.y>=b.basin.bottom_node.next.point.y){b.basin.bottom_node=b.basin.bottom_node.next}if(b.basin.bottom_node==b.basin.left_node){return}b.basin.right_node=b.basin.bottom_node;while(b.basin.right_node.next!=null&&b.basin.right_node.point.y<b.basin.right_node.next.point.y){b.basin.right_node=b.basin.right_node.next}if(b.basin.right_node==b.basin.bottom_node){return}b.basin.width=b.basin.right_node.point.x-b.basin.left_node.point.x;b.basin.left_highest=b.basin.left_node.point.y>b.basin.right_node.point.y;p2t.sweep.FillBasinReq(b,b.basin.bottom_node)};p2t.sweep.FillBasinReq=function(c,a){if(p2t.sweep.IsShallow(c,a)){return}p2t.sweep.Fill(c,a);var b;if(a.prev==c.basin.left_node&&a.next==c.basin.right_node){return}else{if(a.prev==c.basin.left_node){b=p2t.Orient2d(a.point,a.next.point,a.next.next.point);if(b==p2t.Orientation.CW){return}a=a.next}else{if(a.next==c.basin.right_node){b=p2t.Orient2d(a.point,a.prev.point,a.prev.prev.point);if(b==p2t.Orientation.CCW){return}a=a.prev}else{if(a.prev.point.y<a.next.point.y){a=a.prev}else{a=a.next}}}}p2t.sweep.FillBasinReq(c,a)};p2t.sweep.IsShallow=function(c,b){var a;if(c.basin.left_highest){a=c.basin.left_node.point.y-b.point.y}else{a=c.basin.right_node.point.y-b.point.y}if(c.basin.width>a){return true}return false};p2t.sweep.FillEdgeEvent=function(c,b,a){if(c.edge_event.right){p2t.sweep.FillRightAboveEdgeEvent(c,b,a)}else{p2t.sweep.FillLeftAboveEdgeEvent(c,b,a)}};p2t.sweep.FillRightAboveEdgeEvent=function(c,b,a){while(a.next.point.x<b.p.x){if(p2t.Orient2d(b.q,a.next.point,b.p)==p2t.Orientation.CCW){p2t.sweep.FillRightBelowEdgeEvent(c,b,a)}else{a=a.next}}};p2t.sweep.FillRightBelowEdgeEvent=function(c,b,a){if(a.point.x<b.p.x){if(p2t.Orient2d(a.point,a.next.point,a.next.next.point)==p2t.Orientation.CCW){p2t.sweep.FillRightConcaveEdgeEvent(c,b,a)}else{p2t.sweep.FillRightConvexEdgeEvent(c,b,a);p2t.sweep.FillRightBelowEdgeEvent(c,b,a)}}};p2t.sweep.FillRightConcaveEdgeEvent=function(c,b,a){p2t.sweep.Fill(c,a.next);if(a.next.point!=b.p){if(p2t.Orient2d(b.q,a.next.point,b.p)==p2t.Orientation.CCW){if(p2t.Orient2d(a.point,a.next.point,a.next.next.point)==p2t.Orientation.CCW){p2t.sweep.FillRightConcaveEdgeEvent(c,b,a)}else{}}}};p2t.sweep.FillRightConvexEdgeEvent=function(c,b,a){if(p2t.Orient2d(a.next.point,a.next.next.point,a.next.next.next.point)==p2t.Orientation.CCW){p2t.sweep.FillRightConcaveEdgeEvent(c,b,a.next)}else{if(p2t.Orient2d(b.q,a.next.next.point,b.p)==p2t.Orientation.CCW){p2t.sweep.FillRightConvexEdgeEvent(c,b,a.next)}else{}}};p2t.sweep.FillLeftAboveEdgeEvent=function(c,b,a){while(a.prev.point.x>b.p.x){if(p2t.Orient2d(b.q,a.prev.point,b.p)==p2t.Orientation.CW){p2t.sweep.FillLeftBelowEdgeEvent(c,b,a)}else{a=a.prev}}};p2t.sweep.FillLeftBelowEdgeEvent=function(c,b,a){if(a.point.x>b.p.x){if(p2t.Orient2d(a.point,a.prev.point,a.prev.prev.point)==p2t.Orientation.CW){p2t.sweep.FillLeftConcaveEdgeEvent(c,b,a)}else{p2t.sweep.FillLeftConvexEdgeEvent(c,b,a);p2t.sweep.FillLeftBelowEdgeEvent(c,b,a)}}};p2t.sweep.FillLeftConvexEdgeEvent=function(c,b,a){if(p2t.Orient2d(a.prev.point,a.prev.prev.point,a.prev.prev.prev.point)==p2t.Orientation.CW){p2t.sweep.FillLeftConcaveEdgeEvent(c,b,a.prev)}else{if(p2t.Orient2d(b.q,a.prev.prev.point,b.p)==p2t.Orientation.CW){p2t.sweep.FillLeftConvexEdgeEvent(c,b,a.prev)}else{}}};p2t.sweep.FillLeftConcaveEdgeEvent=function(c,b,a){p2t.sweep.Fill(c,a.prev);if(a.prev.point!=b.p){if(p2t.Orient2d(b.q,a.prev.point,b.p)==p2t.Orientation.CW){if(p2t.Orient2d(a.point,a.prev.point,a.prev.prev.point)==p2t.Orientation.CW){p2t.sweep.FillLeftConcaveEdgeEvent(c,b,a)}else{}}}};p2t.sweep.FlipEdgeEvent=function(f,i,h,g,a){var c=g.NeighborAcross(a);if(c==null){return}var e=c.OppositePoint(g,a);if(p2t.InScanArea(a,g.PointCCW(a),g.PointCW(a),e)){p2t.sweep.RotateTrianglePair(g,a,c,e);f.MapTriangleToNodes(g);f.MapTriangleToNodes(c);if(a==h&&e==i){if(h==f.edge_event.constrained_edge.q&&i==f.edge_event.constrained_edge.p){g.MarkConstrainedEdge(i,h);c.MarkConstrainedEdge(i,h);p2t.sweep.Legalize(f,g);p2t.sweep.Legalize(f,c)}else{}}else{var b=p2t.Orient2d(h,e,i);g=p2t.sweep.NextFlipTriangle(f,b,g,c,a,e);p2t.sweep.FlipEdgeEvent(f,i,h,g,a)}}else{var d=p2t.sweep.NextFlipPoint(i,h,c,e);p2t.sweep.FlipScanEdgeEvent(f,i,h,g,c,d);p2t.sweep.EdgeEvent(f,i,h,g,a)}};p2t.sweep.NextFlipTriangle=function(f,e,a,c,d,g){var b;if(e==p2t.Orientation.CCW){b=c.EdgeIndex(d,g);c.delaunay_edge[b]=true;p2t.sweep.Legalize(f,c);c.ClearDelunayEdges();return a}b=a.EdgeIndex(d,g);a.delaunay_edge[b]=true;p2t.sweep.Legalize(f,a);a.ClearDelunayEdges();return c};p2t.sweep.NextFlipPoint=function(b,a,d,e){var c=p2t.Orient2d(a,e,b);if(c==p2t.Orientation.CW){return d.PointCCW(e)}else{if(c==p2t.Orientation.CCW){return d.PointCW(e)}else{return undefined}}};p2t.sweep.FlipScanEdgeEvent=function(e,i,g,h,f,a){var b=f.NeighborAcross(a);if(b==null){return}var d=b.OppositePoint(f,a);if(p2t.InScanArea(g,h.PointCCW(g),h.PointCW(g),d)){p2t.sweep.FlipEdgeEvent(e,g,d,b,d)}else{var c=p2t.sweep.NextFlipPoint(i,g,b,d);p2t.sweep.FlipScanEdgeEvent(e,i,g,h,b,c)}};